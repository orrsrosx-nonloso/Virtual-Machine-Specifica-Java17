## Chapter 3. Compiling for the Java Virtual Machine
Java虚拟机是为支持Java编程语言而设计的。Oracle的JDK软件包含从Java编程语言编写的源代码到Java虚拟机指令集的编译器，以及实现Java虚拟机本身的运行时系统。了解编译器是如何利用Java虚拟机的，对于未来的编译器编写者和试图了解Java虚拟机本身的人都很有用。本章的编号章节不规范。

请注意，术语“编译器”有时用于指从Java虚拟机的指令集到特定CPU的指令集的转换器。这种转换器的一个示例是即时(JIT)代码生成器，它仅在加载Java虚拟机代码之后生成特定于平台的指令。本章不讨论与代码生成相关的问题，只讨论与将用Java编程语言编写的源代码编译为Java虚拟机指令相关的问题。
### 3.1. Format of Examples
本章主要包括源代码示例以及Oracle JDK 1.0.2版本中的javac编译器为示例生成的带注释的Java虚拟机代码清单。Java虚拟机代码是用Oracle的javap实用程序输出的非正式“虚拟机汇编语言”编写的，随JDK发布。您可以使用javap生成编译方法的其他示例。

任何读过汇编代码的人都应该熟悉示例的格式。每条指令的形式为:
```
<index> <opcode> [ <operand1> [ <operand2>... ]] [<comment>]
```

<index>是包含该方法的Java虚拟机代码字节的数组中指令的操作码的索引。或者，<index>可以被认为是方法开始处的字节偏移量。<opcode>是指令操作码的助记符，零个或多个<operandN>是指令的操作数。可选的<comment>在行尾注释语法中给出:
```
8   bipush 100     // Push int constant 100
```
注释中的一些内容是由javap发出的;其余部分由作者提供。每条指令前面的<index>可以用作控制转移指令的目标。例如，goto8指令将控制转移到索引为8的指令。注意，Java虚拟机控制传输指令的实际操作数是这些指令的操作码地址的偏移量;这些操作数由javap显示(在本章中展示)，更容易将偏移量读取到它们的方法中。

在表示运行时常数池索引的操作数前面加一个散列符号，然后在指令后面加一个注释，标识所引用的运行时常数池项，如下所示:
```
10  ldc #1         // Push float constant 100.0
or:
9   invokevirtual #4    // Method Example.addTwo(II)I
```
出于本章的目的，我们不担心指定诸如操作数大小之类的细节。

3.2. Use of Constants, Local Variables, and Control Constructs常量、局部变量和控制结构的使用